<!-- MENU BURGER -->
<div class="burger" onclick="toggleMenu()">â˜°</div>

<style>
.bottone-standard {
    width: 100%;
    padding: 0.6rem;
    color: white;
    font-weight: bold;
    font-size: 1rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    box-sizing: border-box;
}

.bottone-esci {
    background-color: #aaa;
}

.bottone-cambia {
    background-color: #888;
}

.bottone-salva {
    background-color: #556b5d;
}
</style>

<div id="sideMenu" class="side-menu">
    <button onclick="toggleMenu()" class="close-btn">&times;</button>

    {% if utente %}
        <p style="margin-top: 1rem; font-size: 1rem;">ðŸ‘‹ <strong>{{ utente.nome }}</strong></p>

        {% if regali_utente %}
            <div style="margin-top: 1.5rem;">
                <p style="font-weight: bold; margin-bottom: 0.5rem;">I tuoi regali:</p>
                <ul style="padding-left: 0; list-style: none; display: flex; flex-direction: column; gap: 1rem;">
                    {% for r in regali_utente %}
                    <li style="border: 1px solid #ccc; border-radius: 8px; padding: 0.8rem; background-color: #fdfdfd;">
                        <strong style="display: block; font-size: 1rem; color: #333;">{{ r.nome }}</strong>
                        {% if r.prezzo %}
                            <span style="display: block; color: #666; margin-bottom: 0.6rem;">{{ r.prezzo }} â‚¬</span>
                        {% endif %}

                        {% if r.link %}
                        <a href="{{ r.link }}" target="_blank" rel="noopener noreferrer" style="
                            display: block;
                            background-color: #556b5d;
                            color: white;
                            text-align: center;
                            padding: 0.4rem;
                            border-radius: 6px;
                            text-decoration: none;
                            font-size: 0.85rem;
                            margin-bottom: 0.4rem;
                        ">Vai alla pagina dell'articolo</a>
                        {% endif %}

                        <form method="post" action="{% url 'annulla_prenotazione' r.id %}" style="margin: 0;">
                            {% csrf_token %}
                            <button type="submit" style="
                                width: 100%;
                                background-color: #b23b3b;
                                color: white;
                                border: none;
                                padding: 0.4rem;
                                font-size: 0.85rem;
                                border-radius: 6px;
                                cursor: pointer;
                            ">Elimina</button>
                        </form>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        {% else %}
            <p style="font-style: italic; margin-top: 1rem;">Nessun regalo selezionato</p>
        {% endif %}

        <!-- Separatore visivo -->
        <hr style="margin: 1.5rem 0; border: none; border-top: 1px solid #ccc;">

        <!-- Blocchi azione -->
        <div style="display: flex; flex-direction: column; gap: 0.8rem;">
            {% if request.GET.mostra_modifica_nome %}
            <form method="post" action="{% url 'cambia_nome' %}">
                {% csrf_token %}
                <input type="text" name="nome" value="{{ utente.nome }}" placeholder="Nuovo nome" style="
                    width: 100%;
                    padding: 0.4rem;
                    border: 1px solid #ccc;
                    border-radius: 6px;
                    font-size: 0.9rem;
                    box-sizing: border-box;
                ">
                <button type="submit" class="bottone-standard bottone-salva">Salva nome</button>
            </form>
            {% else %}
            <a href="?mostra_modifica_nome=1" class="bottone-standard bottone-cambia">Cambia nome</a>
            {% endif %}

            <form method="post" action="{% url 'logout_utente' %}">
                {% csrf_token %}
                <button type="submit" class="bottone-standard bottone-esci">Esci</button>
            </form>
        </div>

    {% else %}
        <p style="margin-top: 2rem;">
            <a href="{% url 'registrazione' %}" style="
                display: inline-block;
                background-color: #556b5d;
                color: white;
                padding: 0.5rem 1rem;
                border-radius: 6px;
                text-decoration: none;
            ">Registrati</a>
        </p>
    {% endif %}
</div>